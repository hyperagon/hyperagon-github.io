+++
title = 'Daarknet 9'
summary = 'What to do with labeled images.'
date = 2024-04-16T09:34:34+01:00
draft = false
tags = ['yolo', 'goal 3', 'google colab', 'jupyter notebook', 'github']
+++
So it seems that [Darknet](https://pjreddie.com/darknet/yolo/) was only using  the **CPUU**.
So I digged a little and found [this bug](https://github.com/pjreddie/darknet/issues/488#issuecomment-459282463) that says that we should add `-gpus 0` to our call.

Adding that, we get:
```
!cd $DN; ./darknet detector -dont_show -map train $DN/data/obj.data $DN/cfg/yolov3-train.cfg backup/yolov3-train_last.weights -gpus 0
```

But what about the other options like **AVX**? If we can force Darknet to use the **GPU** we could add those back to thed Makefile.
```
# https://stackoverflow.com/questions/39086/search-and-replace-a-line-in-a-file-in-python

f = open(DN + '/Makefile', 'r')
lines = ''
for line in f:
    if line.find('GPU=0') != -1:
        line = line.replace('GPU=0', 'GPU=1')
    if line.find('CUDNN=0') != -1:
       line = line.replace('CUDNN=0', 'CUDNN=1')
    if line.find('CUDNN_HALF=0') != -1:
       line = line.replace('CUDNN_HALF=0', 'CUDNN_HALF=1')
    if line.find('OPENCV=0') != -1:
        line = line.replace('OPENCV=0', 'OPENCV=1')
    if line.find('AVX=0') != -1:
       line = line.replace('AVX=0', 'AVX=1')
    if line.find('OPENMP=0') != -1:
        line = line.replace('OPENMP=0', 'OPENMP=1')
    lines += line
f.close()

g = open(DN + '/Makefile', 'w')
g.write(lines)
g.close()
```

Nevermind, it still created `6 permanent CPU threads`, which makes me think that it only used **CPU** instead of the desired **GPU**.
