+++
title = "Godot woes"
summary = "What happened to the web export?"
date = 2024-07-01T09:34:34+01:00
draft = false
tags = ['godot', 'playcanvas']
+++
Porting the [Untitled Running Game](https://hyperagon.itch.io/untitld-running-game) is getting interesting since I know how the [Godot Engine](https://godotengine.org/) works, it's a confortable editor as long as you know what you're doing. Whike unfortunate that you'll likely need to know *GDScript* it is for the best.

Just look at the movement:
```
Movement.prototype.update = function(dt) {
   var isRunning = false;

   var z = 0;
   var x = 0;

    if(this.app.keyboard.isPressed(pc.KEY_W) || this.app.keyboard.isPressed(pc.KEY_UP)) {
        z = 1;
    }

    if(this.app.keyboard.isPressed(pc.KEY_S) || this.app.keyboard.isPressed(pc.KEY_DOWN)) {
        z = -1;
    }

    if(this.app.keyboard.isPressed(pc.KEY_A) || this.app.keyboard.isPressed(pc.KEY_LEFT)) {
        x = 1;
    }

    if(this.app.keyboard.isPressed(pc.KEY_D) || this.app.keyboard.isPressed(pc.KEY_RIGHT)) {
        x = -1;
    }

    if (x != 0 || z != 0) {
        this.entity.translate(x * this.speed, 0, z * this.speed);

        if(z != 0 && x != 0) {
            if (z > 0) {
                this.entity.setLocalEulerAngles(0, x * 45, 0);
            } else {
                this.entity.setLocalEulerAngles(0, x * 45 + x * 90, 0);
            }
        } else if(x != 0) {
            this.entity.setLocalEulerAngles(0, x * 90, 0);
        } else if (z > 0) {
            this.entity.setLocalEulerAngles(0, 0, 0);
        } else if (z < 0) {
            this.entity.setLocalEulerAngles(-180, 0, -180);
        }

        isRunning = true;
    }
    
    this.timer -= dt;

    if (isRunning && this.timer < 0) {
        this.timer = 0.15 + dt;
        this.entity.sound.stop("Step");
        this.entity.sound.play("Step");
    }

    if(isRunning) {
        this.speed -= dt;
        if (this.speed < this.minSpeed) {
            this.speed = this.minSpeed;
        }
    }

    this.entity.anim.setBoolean('running', isRunning);
}
```

And compare it to the new code:

```
func _input(event):	
	if event.is_action_pressed('ui_up'):
		z = 1
	elif event.is_action_pressed('ui_down'):
		z = -1
	elif event.is_action_released('ui_up') or event.is_action_released('ui_down'):
		z = 0
		
	if event.is_action_pressed('ui_right'):
		x = -1
	elif event.is_action_pressed('ui_left'):
		x = 1
	elif event.is_action_released('ui_left') or event.is_action_released('ui_right'):
		x = 0
	
func _physics_process(_delta):
	...
	
	isRunning = false
	
	if x != 0 and z != 0:
		isRunning = true
		if z > 0:
			$Rig.rotation_degrees = Vector3(0, x * 45, 0)
		else:
			$Rig.rotation_degrees = Vector3(0, -x * (180+45), 0)
	elif x != 0:
		$Rig.rotation_degrees = Vector3(0, x * 90, 0)
		isRunning = true
	elif z > 0:
		$Rig.rotation_degrees = Vector3(0, 0, 0)
		isRunning = true
	elif z < 0:
		$Rig.rotation_degrees = Vector3(0, 180, 0)
		isRunning = true

	position += Vector3(x * SPEED, 0, z * SPEED)
	update_animation_tree(_delta)

func update_animation_tree(_delta):
	animation_tree['parameters/conditions/isIdle'] = !isRunning
	animation_tree['parameters/conditions/isRunning'] = isRunning
```

Of courae this is teeleporting the Player arround and not how you us physics so there's no collision.
